<html xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.0.2/tailwind.min.css">
  <title>Employee Dashboard</title>
  <style>
    /* Your custom CSS styles here */
    .send-email-button {
      background-color: #3490dc;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
    }

    .send-email-button:hover {
      background-color: #2779bd;
    }

    .add-event-form {
      display: none;
    }

    .sidebar-link {
      margin-bottom: 10px;
      padding: 10px 20px;
      border-radius: 5px;
      color: #ccc;
      text-decoration: none;
      transition: background-color 0.3s, color 0.3s;
      cursor: pointer;
    }

    .sidebar-link:hover {
      background-color: #555;
      color: #fff;
    }

    .content-area {
      margin-left: 240px;
      padding: 20px;
    }

    .content-title {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 1rem;
    }

    #content {
      margin-left: 260px;
      padding: 20px;
      transition: margin-left 0.3s;
    }

    #sidebar {
      width: 240px;
      height: 100vh;
      background-color: rgba(38, 36, 36, 0.51);
      position: fixed;
      top: 0;
      left: 0;
      padding-top: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: background-color 0.3s;
    }

    * {
      color: aliceblue;
    }

    .sidebar-link.active {
      background-color: #555;
      color: #fff;
    }

    .sidebar-link.active {
      background-color: #555;
      color: #fff;
    }

    table {
      border-collapse: collapse;
      width: 100%;
    }

    th,
    td {
      padding: 8px;
      text-align: left;
    }

    .add-event-form {
      background-color: #333030;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.1);
      width: 50%;
    }

    .add-event-form h2 {
      font-size: 1.5rem;
      margin-bottom: 10px;
    }

    .add-event-form label {
      display: block;
      margin-bottom: 5px;
    }

    .add-event-form input,
    .add-event-form textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      margin-bottom: 10px;
      color: black;
    }

    .add-event-form button {
      background-color: #3490dc;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
    }

    .add-event-form button:hover {
      background-color: #2779bd;
    }

    th {
      background-color: #282626;
    }

    tr {
      background-color: #4a5568;
    }

    tr:hover {
      background-color: #4b8aa1;
    }

    .message-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 9999;
    }

    .message {
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0px 2px 14px rgba(0, 0, 0, 0.1);
      background-color: #d36a6a;
      color: #333;
      margin-bottom: 10px;
    }

    .message p {
      margin: 0;
      padding: 5px 10px;
    }

    .logout-link {
      padding: 10px 20px;
      border-radius: 5px;
      color: #ccc;
      text-decoration: none;
      background-color: #962d44;
      transition: background-color 0.3s, color 0.3s;
      display: block;
      width: 100%;
      text-align: center;
    }

    .logout-link:hover {
      background-color: #555;
      color: #fff;
    }
  </style>
</head>

<body style="background: #962d44">
  
  <div id="sidebar" class="bg-gray-900 text-white h-screen w-64 fixed top-0 left-0 p-4">
    <h2 class="text-xl font-semibold mb-4" th:text="${employee.username} + ' Dashboard' "></h2>





    <a href="#" class="sidebar-link active bg-blue-500" onclick="showAddAdmin()">
      <svg class="w-6 h-6 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd"
          d="M10 18a8 8 0 100-16 8 8 0 000 16zm-1.105-6.972a.5.5 0 00-.002 0h-.001a.5.5 0 00-.442.383l-.093.498-.504.083a.5.5 0 00-.263.876l.363.36-.082.503a.5.5 0 00.294.524.498.498 0 00.566-.122l.407-.405.407.404a.498.498 0 00.565.122.5.5 0 00.293-.524l-.082-.504.363-.36a.5.5 0 00-.262-.876l-.504-.082-.094-.498a.5.5 0 00-.444-.383h-.001a.5.5 0 00-.002 0z"
          clip-rule="evenodd"></path>
      </svg>


      View Tasks
      <a href="{{ url_for('logout') }}" class="logout-link" style="margin-top: auto; margin-bottom: 0;">
        Logout
      </a>

  </div>
  <div id="content" class="content-area">
    <!-- Main content area -->
    <h1 id="content-title" class="content-title">View Tasks</h1>





    <div id="add-admin-content" class="hidden" style="display: block;">

      <form method="get" th:action="@{/employee/dashboard}">
        <label>
          <input type="checkbox" name="filterByStatus" th:checked="${filterByStatus ? 'checked' : null}"
            onchange="this.form.submit()" />
          Filter by status
        </label>
      </form>
      <table class="rounded-lg overflow-hidden">
        <thead class="bg-gray-100">
          <tr>
            <th class="text-left py-3 px-4 font-semibold">Tasks title</th>
            <th class="text-left py-3 px-4 font-semibold">Description</th>
            <th class="text-left py-3 px-4 font-semibold">Deadline</th>
            <th class="text-left py-3 px-4 font-semibold">Status</th>
            <th class="text-left py-3 px-4 font-semibold">Action</th>
          </tr>
        </thead>
        <tbody id="task-table-body">
          <!-- Rows will be populated by JavaScript -->
      </tbody>
      </table>
    </div>




  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      fetch('/api/employee/tasks')
        .then(response => {
          if (!response.ok) {
            throw new Error('HTTP error ' + response.status);
          }
          return response.json();
        })
        .then(tasks => {
          const tbody = document.getElementById('task-table-body');
          tbody.innerHTML = ''; // clear any placeholder
          if (!tasks || !Array.isArray(tasks) || tasks.length === 0) {
            tbody.innerHTML = `<tr><td colspan="5" class="text-center">No tasks assigned!</td></tr>`;
          } else {
            tasks.forEach(task => {
              const deadline = task.deadline ? new Date(task.deadline).toLocaleString() : '';
              tbody.innerHTML += `
                 <tr>
                   <td>${task.title ?? ''}</td>
                   <td>${task.description ?? ''}</td>
                   <td>${deadline}</td>
                   <td>${task.status ?? ''}</td>
                   <td>${task.status === 'COMPLETED' ? 'âœ”' : 'Pending'}</td>
                 </tr>
              `;
            });
          }
        })
        .catch(error => {
          console.error('Failed to load tasks:', error);
          document.getElementById('task-table-body').innerHTML =
            `<tr><td colspan="5" class="text-center">Failed to load tasks!</td></tr>`;
        });
    });
    </script>




</body>

</html>